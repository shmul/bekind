<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./simple-grid/simplegrid.css">
    <link rel="stylesheet" href="./simple.css/2.1.1/simple.min.css">
    <link rel="stylesheet" href="./bekind.css">
    <script src="https://kit.fontawesome.com/7041d535c5.js" crossorigin="anonymous"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="./htmx/1.8.4/htmx.min.js"></script>
    <title>Zifim - Pace Calculator</title>
  </head>
  <body>
    <header class="sticky">
      <div class="grid grid-pad">
        <div class="col-1-3">
          <nav>
            <h2>
              <a href="https://github.com/shmul/zifim/" target="_blank"><i class="fa-brands fa-github"></i></a>
              <a href="https://www.mixcloud.com/zifim1062fm/" target="_blank"><i class="fa-brands fa-mixcloud"></i></a>
              <a href="https://www.instagram.com/zifim1062fm/" target="_blank"><i class="fa-brands fa-instagram"></i></a>
              <a href="https://www.facebook.com/zifim1062fm/" target="_blank"><i class="fa-brands fa-facebook"></i></a>
            </h2>
          </nav>
        </div>
        <div class="col-1-3">
        </div>
        <div class="col-1-3">
          <img alt="zifim logo" src="./images/zifim-logo.jpg" />
        </div>
      </div>
      <script>
       function perK(min,sec) {
         let mn = parseInt(min),
             sc = parseInt(sec);
         return (isNaN(mn) ? 0 : mn)*60+(isNaN(sc) ? 0 : sc);
       }

       function pn(n) {
         return Math.floor(n).toFixed(0);
       }

       function twoD(n) {
         return String(n).padStart(2,'0');
       }

       function pace(min,sec,perc) {
         let p = 2-perc,
             s = perK(min,sec)*p,
             m = pn(s/60),
             c = pn(s%60);
         return m+':'+twoD(c);
       }

       function overall(min,sec,dist) {
         let s = perK(min,sec)*dist,
             h = pn(s/3600),
             m = pn(s/60-h*60),
             c = (s%60).toFixed(0);
         return h+':'+twoD(m)+':'+twoD(c);
       }
      </script>
    </header>
    <main class="content">
      <div x-data="{
                   predefined: [1.1,1.05,1,0.95,0.9,0.85,0.8], min: 5, sec: 0, free: 102,
                   distances: [1,3,5,10,15,21.1,42.2]
                   }">
        <div class="col-1-2">
          <table>
            <tr>
              <th colspan="2">
                <form>
                  <label for="base">Base Pace:</label>
                  <input id="min" type="number" class="numbers" x-model="min" min="2" max="7" />
                  <input id="sec" type="number" class="numbers" x-model="sec" min="0" max="59" />
                </form>
              </th>
            </tr>
            <tr>
              <td>
                <label for="base"></label>
                <input id="free" type="number" class="numbers" x-model="free" min="50" max="150" /> %
              </td>
              <td>
                <span x-html="pace(min,sec,free/100)">
                </span>
              </td>
            </tr>
            <template x-for="p in predefined">
              <tr>
                <td><span x-html="(p*100).toFixed(0) + ' %'"></span></td>
                <td><span x-html="pace(min,sec,p)"></span></td>
              </tr>
              <!-- span x-html="(p*100).toFixed(0) +'% => '+pace(min,sec,p)"></span-->
            </template>
          </table>
        </div>
        <div class="col-1-2">
          <table>
            <tr>
              <th colspan="2">Races</th>
            </tr>
            <template x-for="d in distances">
              <tr>
                <td><span x-html="d + ' km'"></span></td>
                <td><span x-html="overall(min,sec,d)"></span></td>
              </tr>
            </template>
          </table>
        </div>
      </div>
    </main>

  </body>
</html>
